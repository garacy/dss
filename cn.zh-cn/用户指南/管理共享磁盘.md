# 管理共享磁盘<a name="ZH-CN_TOPIC_0170873650"></a>

## 如何使用VBD和SCSI共享云硬盘？<a name="section12480172712221"></a>

您可以创建VBD类型的共享磁盘和SCSI类型的共享磁盘。建议将共享磁盘挂载至位于同一个反亲和性云服务器组内的ECS，以提高业务可靠。

-   VBD类型的共享磁盘：创建的共享磁盘默认为VBD类型，该类型磁盘可提供虚拟块存储设备，不支持SCSI锁。当您部署的应用需要使用SCSI锁时，则需要创建SCSI类型的共享磁盘。
-   SCSI类型的共享磁盘：SCSI类型的共享磁盘支持SCSI锁。

    >![](public_sys-resources/icon-notice.gif) **须知：**   
    >-   为了提升数据的安全性，建议您结合云服务器组的反亲和性一同使用SCSI锁，即将SCSI类型的共享磁盘挂载给同一个反亲和性云服务器组内的ECS。  
    >-   如果ECS不属于任何一个反亲和性云服务器组，则不建议您为该ECS挂载SCSI类型的共享磁盘，否则SCSI锁无法正常使用并且则会导致您的数据存在风险。  

    反亲和性和SCSI锁的相关概念：

    -   云服务器组的反亲和性：ECS在创建时，将会分散地创建在不同的物理主机上，从而提高业务的可靠性。您只能在创建ECS的时候选择虚拟机组，对于现有的ECS，不支持添加云服务器组的操作。

        关于云服务器组，更多详情请参见[管理云服务器组](https://support.huaweicloud.com/usermanual-ecs/zh-cn_topic_0032980085.html)。

    -   SCSI锁的实现机制：通过SCSI Reservation命令来进行SCSI锁的操作。如果一台ECS给磁盘传输了一条SCSI Reservation命令，则这个磁盘对于其他ECS就处于锁定状态，避免了多台ECS同时对磁盘执行读写操作而导致的数据损坏。
    -   云服务器组和SCSI锁的关系：同一个磁盘的SCSI锁无法区分单个物理主机上的多台ECS，因此只有当ECS位于不同物理主机上时才可以支持SCSI锁，因此建议您结合云服务器组的反亲和性一起使用SCSI锁命令。


## 创建共享磁盘<a name="section11828291"></a>

您可以创建VBD类型的共享磁盘和SCSI类型的共享磁盘。

-   VBD类型的共享磁盘：创建的共享磁盘默认为VBD类型，该类型磁盘可提供虚拟块存储设备，不支持SCSI锁。当您部署的应用需要使用SCSI锁时，则需要创建SCSI类型的共享磁盘。
-   SCSI类型的共享磁盘：SCSI类型的共享磁盘支持SCSI锁。

    如果将SCSI类型共享磁盘挂载至ECS时，需要结合云服务器组的反亲和性一同使用，SCSI锁才会生效。

    >![](public_sys-resources/icon-notice.gif) **须知：**   
    >-   为了提升数据的安全性，建议您结合云服务器组的反亲和性一同使用SCSI锁，即将SCSI类型的共享磁盘挂载给同一个反亲和性云服务器组内的ECS。  
    >-   如果ECS不属于任何一个反亲和性云服务器组，则不建议您为该ECS挂载SCSI类型的共享磁盘，否则SCSI锁无法正常使用并且则会导致您的数据存在风险。  

    反亲和性和SCSI锁的相关概念：

    -   云服务器组的反亲和性：ECS在创建时，将会分散地创建在不同的物理主机上，从而提高业务的可靠性。您只能在创建ECS的时候选择虚拟机组，对于现有的ECS，不支持添加云服务器组的操作。

        关于云服务器组，更多详情请参见[管理云服务器组](https://support.huaweicloud.com/usermanual-ecs/zh-cn_topic_0032980085.html)。

    -   SCSI锁的实现机制：通过SCSI Reservation命令来进行SCSI锁的操作。如果一台ECS给磁盘传输了一条SCSI Reservation命令，则这个磁盘对于其他ECS就处于锁定状态，避免了多台ECS同时对磁盘执行读写操作而导致的数据损坏。
    -   云服务器组和SCSI锁的关系：同一个磁盘的SCSI锁无法区分单个物理主机上的多台ECS，因此只有当ECS位于不同物理主机上时才可以支持SCSI锁。不在同一个反亲和性组的ECS，可能位于同一个物理主机上，从而导致了SCSI锁无法生效，因此建议您结合云服务器组的反亲和性一起使用SCSI锁命令。


## 挂载共享磁盘<a name="section39345760"></a>

普通磁盘可以挂载至1台云服务器，而共享磁盘最多可挂载至16台云服务器。

## 删除共享磁盘<a name="section18567520"></a>

由于共享磁盘同时挂载至多台云服务器，因此删除共享磁盘时请卸载所有的挂载点之后再进行删除。

删除共享磁盘的具体操作请参见[删除磁盘](删除磁盘.md)。

## 扩容共享磁盘<a name="section87872218171"></a>

共享磁盘必须位于“可用”状态才可以扩容，具体操作请参见[扩容状态为“可用”的磁盘](扩容状态为-可用-的磁盘.md)。

